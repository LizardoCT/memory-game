<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <style>
    body{
      margin: 0;
      height: 100dvh;
      background: #74ebd5;
      background: -webkit-linear-gradient(to right, #ACB6E5, #74ebd5);
      background: linear-gradient(to right, #ACB6E5, #74ebd5);
      font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    }

    h1{
      text-align: center;
      font: 1.7rem;
      margin-top: 0;
      margin-bottom: 3rem;
      color: #212121;
      text-transform: uppercase;
    }

    .container {
      display: flex;
      flex-direction: column;
      justify-content: center;
      height: 100%;
      max-width: 650px;
      margin: 0 auto;
    }

    .game-info {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 2rem;
    }

    .lives {
      font-size: 1.2rem;
      font-weight: bold;
      color: #212121;
    }

    p {
      margin: 0 0 20px;
    }

    #game-message-1{
      font-weight: bold;
      font-size: 1.5rem;
    }

    .game-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 1rem;
    }

    .card {
      position: relative;
      aspect-ratio: 1;
      background: #f1f1f1;
      border-radius: 10px;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2rem;
      
      transform-style: preserve-3d;
      transition: all 1.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      box-shadow: 0px 5px 10px rgba(0, 0, 0, .1);
    }

    .card img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      border-radius: 10px;
      pointer-events: none;
      transform: rotateY(-180deg);
      backface-visibility: hidden;
    }

    .card.flipped {
      transform: rotateY(180deg);
      backface-visibility: visible;
    }

    button {
      padding: 0.5rem 1rem;
      background: #CE0C13;
      color: white;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      font-family: Verdana, Geneva, Tahoma, sans-serif;
      font-weight: bold;
    }

    button:hover {
      background: #ee3036;
    }

    .hidden {
      display: none;
    }

    .game-over {
      position: fixed;
      width: 250px;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: #f1f1f1;
      padding: 2rem;
      border-radius: 8px;
      box-shadow: 0 0 10px rgba(0,0,0,0.2);
      text-align: center;
      z-index: 2;
    }

    .overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5); /* Fondo oscuro semi-transparente */
      z-index: 1; /* Debe estar detr√°s del modal */
    }

    @media screen and (max-width: 700px) {
      .container {
        padding: 0 1rem;
      }
      h1{
        margin-bottom: 5rem;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Memory Game üéÆ</h1>

    <div class="game-info">
      <div class="lives">Vidas: <span id="lives-count">6</span> <span>‚ù§Ô∏è</span></div>
      <button id="restart-button">Reiniciar Juego</button>
    </div>
    
    <div class="game-grid" id="game-grid">
    </div>

    <div id="overlay" class="overlay hidden"></div>
    
    <div id="game-over" class="game-over hidden">
      <p>
        <span id="game-message-1"></span>
        <br>
        <span id="game-message-2"></span>
      </p>
      <button id="play-again">Jugar de nuevo</button>
    </div>
  </div>

<script>
document.addEventListener('DOMContentLoaded', () => {
    const images = [
      './images/beatles.webp',
      './images/blink182.webp',
      './images/fkatwigs.webp',
      './images/fleetwood.webp',
      './images/greenday.webp',
      './images/kiss.webp',
      './images/metallica.webp',
      './images/pinkfloyd.webp'
    ];

    let cards = [];
    let flippedCards = [];
    let lives = 6;
    let isLocked = false;

    function showGameOverMessage(message1, message2) {
      const messageElement1 = document.getElementById('game-message-1');
      const messageElement2 = document.getElementById('game-message-2');

      // Asignar los mensajes a los p√°rrafos
      messageElement1.textContent = message1;
      messageElement2.textContent = message2;

      // Mostrar el modal
      document.getElementById('game-over').classList.remove('hidden');
      // Mostrar el overlay (fondo oscuro)
      document.getElementById('overlay').classList.remove('hidden');
    }

    function createCards() {
      const duplicatedImages = [...images, ...images];
      return duplicatedImages
        .sort(() => Math.random() - 0.5)
        .map((image, index) => ({
          id: index,
          image,
          isFlipped: false,
          isMatched: false
        }));
    }

    function updateUI() {
      document.getElementById('lives-count').textContent = lives.toString();
    }

    function createGameGrid() {
      const gameGrid = document.getElementById('game-grid');
      gameGrid.innerHTML = '';
      
      cards.forEach((card, index) => {
        const cardElement = document.createElement('div');
        cardElement.className = 'card';
        cardElement.dataset.index = index.toString();
        cardElement.textContent = '‚ùì';
        
        cardElement.addEventListener('click', () => handleCardClick(index));
        gameGrid.appendChild(cardElement);
      });
    }

    function flipCard(index, show) {
      const cardElement = document.querySelector(`[data-index="${index}"]`);
      if (show) {
        cardElement.classList.add('flipped');
        cardElement.innerHTML = `<img src="${cards[index].image}" alt="card front">`;
      } else {
        cardElement.classList.remove('flipped');
        cardElement.textContent = '‚ùì';
      }
    }

    function handleCardClick(index) {
      if (
        isLocked ||
        flippedCards.length === 2 ||
        cards[index].isFlipped ||
        cards[index].isMatched
      ) {
        return;
      }

      flipCard(index, true);
      cards[index].isFlipped = true;
      flippedCards.push(index);

      if (flippedCards.length === 2) {
        isLocked = true;

        const [firstIndex, secondIndex] = flippedCards;
        
        if (cards[firstIndex].image === cards[secondIndex].image) {
          cards[firstIndex].isMatched = true;
          cards[secondIndex].isMatched = true;
          isLocked = false;
          flippedCards = [];

          if (cards.every(card => card.isMatched)) {
            setTimeout(() => {
              showGameOverMessage(
                '¬°YOU WIN!',
                'Has ganado el juego ü§ë'
              );
            }, 500);
          }
        } else {
          lives--;
          updateUI();
          
          if (lives <= 0) {
            setTimeout(() => {
              flipCard(firstIndex, false);
              flipCard(secondIndex, false);
              cards[firstIndex].isFlipped = false;
              cards[secondIndex].isFlipped = false;
              flippedCards = [];
              showGameOverMessage(
                '¬°GAME OVER!',
                'Has perdido todas tus vidas üòì'
              );
            }, 1000);
            return;
          }

          setTimeout(() => {
            flipCard(firstIndex, false);
            flipCard(secondIndex, false);
            cards[firstIndex].isFlipped = false;
            cards[secondIndex].isFlipped = false;
            flippedCards = [];
            isLocked = false;
          }, 1000);
        }
      }
    }
    

    function resetMatchedCards(callback) {
      const matchedCards = cards.filter(card => card.isMatched);

      matchedCards.forEach(card => {
        const cardElement = document.querySelector(`[data-index="${card.id}"]`);
        if (cardElement) {
          card.isFlipped = false; // Marcar como no volteada
          flipCard(card.id, false); // Usar la animaci√≥n de volteo existente
        }
      });

      // Esperar a que termine la animaci√≥n antes de continuar
      setTimeout(() => {
        if (callback) callback();
      }, 500); // Ajusta este tiempo seg√∫n la duraci√≥n de tu animaci√≥n
    }

    function restartGame() {
      lives = 6;
      flippedCards = [];
      isLocked = false;
      cards = createCards();
      document.getElementById('game-over').classList.add('hidden');
      document.getElementById('overlay').classList.add('hidden');
      createGameGrid();
      updateUI();
    }

    // Event listeners
    document.getElementById('restart-button').addEventListener('click', restartGame);
    document.getElementById('play-again').addEventListener('click', () => {
      resetMatchedCards(() => {
        restartGame(); // Reinicia el juego despu√©s de voltear las cartas
      });
    });

    // Initialize game
    restartGame();
  });
</script>
</body>
</html>